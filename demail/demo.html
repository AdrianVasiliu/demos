<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN" 
	"http://www.w3.org/TR/html4/strict.dtd">

<html>
<head>
	<title>Dojo Mail</title>
	<link rel="stylesheet" href="demo.css">
</head>
<body class="tundra">
	<div data-dojo-type="dijit/layout/BorderContainer" design="sidebar" id="main" class="app">
		<div data-dojo-type="dijit/layout/ContentPane"
			class="leftTree"
			data-dojo-props="'region': 'leading', 'jsId': 'leading', 'splitter': true">
			<!--
			<div id="treeContainer"></div>
			-->
			<div data-dojo-type="dijit/Tree"
				data-dojo-props="'model': 'folderModel', 'openOnClick': true, 'showRoot': false"></div>
		</div>
		<table data-dojo-type="dojox/grid/DataGrid"
			data-dojo-props="'store': 'csvStore', 'splitter': true, 'height': 'auto', 'region': 'center', 'jsId': 'csvGrid', 'query': '{ Date: \'*\' }">
			<script type="dojo/method" event="onCellContextMenu">
				return true; // allow context menus
			</script>
			<thead>
				<tr>
					<th width="20%">Date</th>
					<th width="auto">Open</th>
					<th>Close</th>
				</tr>
			</thead>
		</table>
		<div data-dojo-type="dijit/layout/ContentPane" data-dojo-props="'region': 'bottom', 'splitter': true"
			style="height: 100px;"
			class="messagePane">
			bottom bar
		</div>
		<!--
		<div dojoType="dijit.layout.ContentPane" region="trailing">
			right side-bar
		</div>
		-->
	</div>

	<!--
	<div dojoType="dijit.Menu" jsId="rightClick" style="display: none;">
		<script type="dojo/method">
			this.bindDomNode(csvGrid.domNode);
		</script>
		<script type="dojo/connect" event="onOpen" args="evt">
			for(var x in evt){
				// console.debug(x);
			}
		</script>
		<div dojoType="dijit.MenuItem" onClick="alert('Hello world');">Enabled Item</div>
		<div dojoType="dijit.MenuItem" disabled="true">Disabled Item</div>
		<div dojoType="dijit.MenuSeparator"></div>
		<div dojoType="dijit.PopupMenuItem">
			<span>Enabled Submenu</span>
			<div dojoType="dijit.Menu" id="submenu2">
				<div dojoType="dijit.MenuItem" onClick="alert('Submenu 1!')">Submenu Item One</div>
				<div dojoType="dijit.MenuItem" onClick="alert('Submenu 2!')">Submenu Item Two</div>
				<div dojoType="dijit.PopupMenuItem">
					<span>Deeper Submenu</span>
					<div dojoType="dijit.Menu" id="submenu4">
						<div dojoType="dijit.MenuItem" onClick="alert('Sub-submenu 1!')">Sub-sub-menu Item One</div>
						<div dojoType="dijit.MenuItem" onClick="alert('Sub-submenu 2!')">Sub-sub-menu Item Two</div>
					</div>
				</div>
			</div>
		</div>
		<div dojoType="dijit.PopupMenuItem" disabled="true">
			<span>Disabled Submenu</span>
			<div dojoType="dijit.Menu" id="submenu3" style="display: none;">
				<div dojoType="dijit.MenuItem" onClick="alert('Submenu 1!')">Submenu Item One</div>
				<div dojoType="dijit.MenuItem" onClick="alert('Submenu 2!')">Submenu Item Two</div>
			</div>
		</div>
		<div dojoType="dijit.CheckedMenuItem" checked="true" onChange="alert('Now set to ' + arguments[0])">Checked</div>
		<div dojoType="dijit.CheckedMenuItem">Not Checked</div>
		<div dojoType="dijit.CheckedMenuItem" checked="true" disabled="true">Checked Disabled</div>
	</div>
	-->
	
	<script src="../config.js"></script>
	<script>
		dojoConfig.modulePaths = {
			"acme": "../demos/demail"
		};
	</script>
	<script type="text/javascript" src="../../dojo/dojo.js"></script>
	<script type="text/javascript">
		require(["dojo/parser", "dojo/_base/lang", "dojox/data/CsvStore",
		"dojo/_base/declare", "dojo/data/ItemFileReadStore", "dijit/Tree", "dijit/tree/ForestStoreModel", "demo/src", "dijit/layout/BorderContainer", "dijit/layout/ContentPane", "dijit/Tree", "dojox/grid/DataGrid"], function (parser, lang, CsvStore, declare, ItemFileReadStore, Tree, ForestStoreModel) {
			parser.parse();

			var csvStore = new CsvStore({
				url: require.toUrl("dojox/charting/tests/data/msft_prices.csv")
			});

			var d = { 
				identifier: 'name',
				label: 'name',
				items: [
					{ 
						name:'Africa', 
						type:'continent', 
						population:'900 million', 
						area: '30,221,532 sq km',
						timezone: '-1 UTC to +4 UTC',
						children:[
							{_reference:'Egypt'}, 
							{_reference:'Kenya'}, 
							{_reference:'Sudan'}
						]
					},
					{ name:'Egypt', type:'country' },
					{ name:'Kenya', type:'country',
						children: [
							{_reference:'Nairobi'}, 
							{_reference:'Mombasa'}
						]
					},
					{ name:'Nairobi', type:'city' },
					{ name:'Mombasa', type:'city' },
					{ name:'Sudan', type:'country', children:[ { _reference:'Khartoum' } ] },
					{ name:'Khartoum', type:'city' },
					{ name:'Asia', type:'continent',
						children: [
							{ _reference: 'China' }, 
							{ _reference: 'India' }, 
							{ _reference: 'Russia' }
						]
					},
					{ name:'China', type:'country' },
					{ name:'India', type:'country' },
					{ name:'Russia', type:'country' }
				]
			};

			for(var x = 0; x < 100; x++){
				d.items.push({ type: "country", name: "country"+x });
				d.items[7].children.push({ _reference: "country"+x });
			}

			var folders = new ItemFileReadStore({ data: d });

			var folderModel =  new ForestStoreModel({
				store: folders, 
				query: { type: "continent" },
				childrenAttrs: [ "children" ]
			});

			declare("acme._TreeNode", dijit._TreeNode, {
				detail: "",
				detailNode: null,
				_onNodeFocus: function(){
					// console.debug(this.domNode);
					this.inherited(arguments);
				},
				_setDetail: function(v){
					this._detailNode.innerHTML = v;
				},
				templatePath: require.toUrl("acme/newTreeNode.html")
			});

			dijit.defaultDuration = 150;

			lang.extend(Tree, {
				templatePath: require.toUrl("acme/newTree.html"),
				_createTreeNode: function(args){
					if(args.label){
						args.detail = ""+args.label.length;
					}
					return new acme._TreeNode(args);
				}
			});
		});
	</script>
</body>
</html>
